@{
    Layout = null;
}

<!DOCTYPE html>

<html style="overflow: hidden">
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
</head>
<body unselectable="on" class="unselectable" style="margin:0">
    <canvas id="glscreen"></canvas>
    <script src="../../Scripts/jquery-2.1.4.min.js"></script>
    <script src="../../Scripts/jquery.signalR-2.2.0.min.js"></script>
    <script>
        $(function () {          
            $(document).ready(function () {
                var gdo = parent.gdo;
                gdo.net.app["Fractals"].initClient();
            });
        });
    </script>

    <script type="text/javascript">
    var gl;
    var canvas;

    window.onload = init;

    function init() {

        // Set up canvas
        canvas = document.getElementById('glscreen');
        gl = canvas.getContext('experimental-webgl');
        canvas.width = 1920;
        canvas.height = 1080;

        // Initialise view port
        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);

        // Create a quad filling the screen
        buffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
        gl.bufferData(
          gl.ARRAY_BUFFER,
          new Float32Array([
            -1.0, -1.0,
             1.0, -1.0,
            -1.0, 1.0,
            -1.0, 1.0,
             1.0, -1.0,
             1.0, 1.0]),
          gl.STATIC_DRAW
        );


        // Shader local variables
        var shaderScript;
        var shaderSource;
        var vertexShader;
        var fragmentShader;

        // Compile vertex shader
        shaderScript = document.getElementById("2d-vertex-shader");
        shaderSource = shaderScript.text;
        vertexShader = gl.createShader(gl.VERTEX_SHADER);
        gl.shaderSource(vertexShader, shaderSource);
        gl.compileShader(vertexShader);

        // Compile fragment shader
        shaderScript = document.getElementById("2d-fragment-shader");
        shaderSource = shaderScript.text;
        fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
        gl.shaderSource(fragmentShader, shaderSource);
        gl.compileShader(fragmentShader);

        // Create program with shaders
        program = gl.createProgram();
        gl.attachShader(program, vertexShader);
        gl.attachShader(program, fragmentShader);
        gl.linkProgram(program);
        gl.useProgram(program);

        // Render the scene
        render();

    }

    function render() {

        // Ensure continuous rendering
        window.requestAnimationFrame(render, canvas);

        // Set position data of vertex shader
        positionLocation = gl.getAttribLocation(program, "a_position");
        gl.enableVertexAttribArray(positionLocation);
        gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);

        // Draw quad
        gl.drawArrays(gl.TRIANGLES, 0, 6);

    }
    </script>

    <script id="2d-vertex-shader" type="x-shader/x-vertex">
        attribute vec2 a_position;

        void main() {
        gl_Position = vec4(a_position, 0, 1);
        }
    </script>

    <script id="2d-fragment-shader" type="x-shader/x-fragment">
        #define NUM_STEPS   100
        #define ZOOM_FACTOR 2.0
        #define WIDTH 1920.0
        #define HEIGHT 1080.0

        #ifdef GL_FRAGMENT_PRECISION_HIGH
        precision highp float;
        #else
        precision mediump float;
        #endif
        precision mediump int;

        void main() {
        vec2 z;
        float x,y;
        int steps;
        // x between -2.05 and 0.95
        // y between -1.3 and 1.3
        float normalizedX = (gl_FragCoord.x / WIDTH) * 3.0 - 2.05;
        float normalizedY = (gl_FragCoord.y / HEIGHT) * 2.6 - 1.3;

        z.x = normalizedX;
        z.y = normalizedY;

        for (int i=0; i<NUM_STEPS; i++) {
                        steps=i;
                        x=(z.x * z.x - z.y * z.y) + normalizedX;
                        y=(z.y * z.x + z.x * z.y) + normalizedY;
                        if((x * x + y * y)>
            4.0) {
            break;
            }

            z.x = x;
            z.y = y;

            }

            float stepFloat = float(steps);
            gl_FragColor = vec4(stepFloat/float(NUM_STEPS), stepFloat/float(NUM_STEPS), 1.0, 1.0);

            }
    </script>

</body>
</html>
